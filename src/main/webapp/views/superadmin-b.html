<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>编辑信息</title>
    <link href="../static/css/reset.css" rel="stylesheet" type="text/css"/>
    <link href="../static/css/editIM.css" rel="stylesheet" type="text/css"/>
    <link href="../static/css/calendar.css" rel="stylesheet"/>

    <script src="../static/js/jquery.js"></script>
    <script src="../static/js/calendar.js" type="text/javascript"></script>
    <script src="../static/js/editIM.js"></script>
    <script src="../static/js/checkUpdateIM.js"></script>
    <style>
        html, body {
            height: 100%
        }
    </style>

</head>
<body>
<div class="contaner">

    <div class="im-content">
        <div class="im-heade">
            <div class="imhead-title">当前页面：<a>修改信息</a></div>
        </div>

        <div class="editim-table">
            <ul class="table-con">
                <li class="edittable-top">
                    <div class="edittable-left">采样信息</div>
                    <div class="edittable-right">
                        <ul>
                            <li>
                                <lable>样品编号</lable>
                                <input class="ypbh" id="" name="sample_id" onblur="checksample_id()"
                                       placeholder='首字母为英文，长度为5-15位' type="text" value="样品编号"/>
                                <span id="sample_id"></span>
                            </li>
                            <li>
                                <input id="" name="id" type="hidden" value="list.id"/>
                                <lable>农产品加工原料类别</lable>
                                <select class="sel" id="cptype" name="crop_category_id" onblur="checkcrop_category_id()"
                                        onchange="cptypes()">


                                </select>
                                <span id="crop_category_id"></span>
                            </li>
                            <li>
                                <lable>品种</lable>
                                <select class="sele" id="cptypess" name="breed" onblur="checkbreed()">
                                    <option>
                                    </option>
                                </select>
                                <span id="breed"></span>
                            </li>
                            <li>
                                <div class="width">
                                    <lable>地点</lable>
                                    <input id="shengs" type="hidden" value="${list.province}"/>
                                    <input id="shisss" type="hidden" value="${list.city}"/>
                                    <input id="xiansss" type="hidden" value="${list.county}"/>
                                    <input id="provinces" name="province" type="hidden" value="${list.province}"/>
                                    <input id="city" name="city" type="hidden" value="${list.city}"/>
                                    <input id="county" name="county" type="hidden" value="${list.county}"/>
                                    <input id="wsx" type="hidden" value=""/>
                                    <select class="province" id="shen" onblur="checkprovince()"
                                            onchange="changeShen(this.value,'shen','shi','xian')">

                                        <option value="${param6}"></option>
                                    </select><span>省</span>
                                    <select class="city" id="shi" onblur="checkprovince()"
                                            onchange="changeShi(this.value,'shen','shi','xian')">
                                        <c:choose>
                                            <c:when test="${param7== '' || param7== null }">

                                            </c:when>
                                            <c:otherwise>
                                                <option value="${param7}"></option>

                                            </c:otherwise>
                                        </c:choose>
                                    </select><span>市</span>
                                    <select class="county" id="xian" onblur="checkprovince()" onchange="xianwsx()">
                                        <c:choose>
                                            <c:when test="${param8== '' || param8== null }">

                                            </c:when>
                                            <c:otherwise>
                                                <option value="${param8}"></option>

                                            </c:otherwise>
                                        </c:choose>

                                    </select><span>县</span>
                                </div>
                                <span class="xc">
											<input id="xiang" name="township" placeholder='可为空' type="text" value=""/>乡
											<input id="cun" name="village" placeholder='可为空' type="text" value=""/>村
											<input id="hu" name="household" placeholder='可为空' type="text"
                                                   value=""/><span>户</span>
										</span>
                                <span id="province"></span>
                            </li>
                            <li>
                                <lable>收获时间</lable>
                                <input type="text">
                                <div id="dd"></div>
                                <span id="harvest_time"></span>
                            </li>
                            <li>
                                <lable>取样时间</lable>
                                <input type="text">
                                <div id="dd-b"></div>
                                <span class="err" id="sampling_time"></span>
                            </li>
                            <li>
                                <lable>取样人</lable>
                                <input type="text">
                                <span id="sampling_people"></span>
                            </li>
                            <li class="jijie">
                                <lable>采集季节及气候特征</lable>
                                <textarea cols="" id="seasonal1" name="seasonal" onblur="checkseasonal()"
                                          rows=""></textarea>
                                <span id="seasonal"></span>
                            </li>
                            <li class="huanjing">
                                <lable>采集地、环境信息描述</lable>
                                <textarea cols="" id="description1" name="description" onblur="checkdescription()"
                                          rows=""></textarea>
                                <span id="description"></span>
                            </li>
                            <li>
                                <lable>真菌污染率</lable>
                                <input id="" name="pollution_rate" onblur="checkpollution_rate()" type="text" value=""/>
                                <span id="pollution_rate"></span>
                            </li>
                        </ul>
                    </div>
                </li>
                <div class='addds'>
                    <c:forEach items="${listtoxin}" var="litoxin">
                        <li class="edittable-middle">
                            <div class="editmiddle-left">
                                毒素信息
                            </div>
                            <div class="editmiddle-right">
                                <ul>
                                    <li>
                                        <lable>毒素种类</lable>
                                        <select id="toxin_id1" name="toxin_id" onblur="checktoxin_id()">
                                            <option value="">请选择</option>
                                            <c:forEach items="${list2}" var="lis">
                                                <option value="${lis.id} "
                                                <c:if test="${litoxin.toxin_id==lis.id}">selected="selected"</c:if>
                                                >${lis.toxin_type}</option>
                                            </c:forEach>
                                        </select>
                                        <span id="toxin_id"></span>
                                    </li>
                                    <li>
                                        <lable>毒素含量</lable>
                                        <input name="toxin_count" onblur="checktoxin_count()" type="text" value=""/>
                                        <input name="edittoxin_id" type="hidden" value="${litoxin.id}"/>
                                        <span id="toxin_count"></span>
                                    </li>
                                    <li>
                                        <a class="del" onclick="qwe(${lis.id});">删除</a>
                                    </li>
                                </ul>
                            </div>
                        </li>
                    </c:forEach>
                </div>
                <div class="add-dsxx">+添加毒素信息</div>
                <div class="add-con">
                    <c:forEach items="${list1}" var="lis">

                        <li class="edittable-bottom">

                            <div class="editbottom-left">产毒菌株信息${lis.sample_info_id}${lis.id}</div>
                            <div class="editbottom-right">
                                <ul>
                                    <li>
                                        <lable>样品编号</lable>
                                        <input class="sample" name="sample_num" readonly type="text" value=""/>
                                        <input name="cid" type="hidden" value="${lis.id}"/>
                                        <span class="err"></span>
                                    </li>
                                    <li>
                                        <lable>菌株原始编号</lable>
                                        <input class="num" name="original_num" type="text" value=""/>
                                        <span class="err"></span>
                                    </li>
                                    <li class="form-a">

                                        <lable>文献信息</lable>
                                        <a class="xz-btn-a">选择文件</a>
                                        <input class="file-name-a" id="" name="wordvalues" placeholder='仅支持doc/docx格式'
                                               readonly type="text" value=""/>
                                        <input class="file-info-a" name="word_addr" onchange="getPhotoSizes(this)"
                                               type="file"/>

                                    </li>
                                    <li class="form-b">

                                        <lable>文本信息</lable>
                                        <a class="xz-btn-b">选择文件</a>
                                        <input class="file-name-b" id="" name="txtvalues" placeholder='仅支持txt格式'
                                               readonly type="text" value=""/>
                                        <input class="file-info-b" name="txt_addr" onchange="getTextSize(this)"
                                               type="file" value="0"/>

                                    </li>
                                    <li class="form-c">

                                        <lable>图片信息</lable>
                                        <a class="xz-btn-c">选择文件</a>
                                        <input class="file-name-c" id="" name="imgvalues" placeholder='仅支持jpg/png格式'
                                               readonly type="text" value=""/>
                                        <input class="file-info-c" name="picture_addr" onchange="getPhotoSize(this)"
                                               type="file" value="0"/>

                                    </li>
                                    <li>
                                        <a class="del" onclick="qwe(${lis.id});">删除</a>
                                    </li>
                                </ul>
                            </div>

                        </li>

                    </c:forEach>
                </div>
            </ul>
            <div class="add-ds">+添加产毒菌株信息</div>
            <div class="footer">
                <a class="baocun" onclick="sub()">修改</a>
                <a class="marginl" onclick="history.go(-1)">返回</a>
            </div>
        </div>

    </div>
</div>
</body>


<!--	<script>

	function getPhotoSize(obj){
    photoExt=obj.value.substr(obj.value.lastIndexOf(".")).toLowerCase();//获得文件后缀名
    console.log(photoExt);
     if(photoExt!='.png' && photoExt!='.jpg'){
        alert("请上传正确的照片格式!");
         obj.value = "";
        console.log(obj.value);
        return false;
    }
    var fileSize = 0;
    var isIE = /msie/i.test(navigator.userAgent) && !window.opera;
    if (isIE && !obj.files) {
         var filePath = obj.value;
         var fileSystem = new ActiveXObject("Scripting.FileSystemObject");
         var file = fileSystem.GetFile (filePath);
         fileSize = file.Size;
    }else {
         fileSize = obj.files[0].size;
    }
    fileSize=Math.round(fileSize/1024*100)/100; //单位为KB


}

function getPhotoSizes(obj){
    photoExt=obj.value.substr(obj.value.lastIndexOf(".")).toLowerCase();//获得文件后缀名
     if(photoExt!='.doc' && photoExt!='.docx'){
        alert("请上传正确的文档格式!");
         obj.value = "";
        console.log(obj.value);
        return false;
    }
    var fileSize = 0;
    var isIE = /msie/i.test(navigator.userAgent) && !window.opera;
    if (isIE && !obj.files) {
         var filePath = obj.value;
         var fileSystem = new ActiveXObject("Scripting.FileSystemObject");
         var file = fileSystem.GetFile (filePath);
         fileSize = file.Size;
    }else {
         fileSize = obj.files[0].size;
    }
    fileSize=Math.round(fileSize/1024*100)/100; //单位为KB


}

function getTextSize(obj){
// 	alert("校验txt");
    photoExt=obj.value.substr(obj.value.lastIndexOf(".")).toLowerCase();//获得文件后缀名
     if(photoExt!='.txt'){
        alert("请上传正确的文档格式!");
         obj.value = "";
        console.log(obj.value);
        return false;
    }
    var fileSize = 0;
    var isIE = /msie/i.test(navigator.userAgent) && !window.opera;
    if (isIE && !obj.files) {
         var filePath = obj.value;
         var fileSystem = new ActiveXObject("Scripting.FileSystemObject");
         var file = fileSystem.GetFile (filePath);
         fileSize = file.Size;
    }else {
         fileSize = obj.files[0].size;
    }
    fileSize=Math.round(fileSize/1024*100)/100; //单位为KB


}
function cptypes(){
		    var oSelect = document.getElementById('cptype');
            var cid = oSelect.value;

		if(cid != ""){

				$.ajax({
				 type:"POST",   //http请求方式
				 url:"selectidtype", //发送给服务器的url
				 dataType:"json",    //传参类型
				 data:{cid:cid},
				 success: function(cc) {

					if($(".selec").length == "0"){
						$("#cptypess").append("<option class='selec' value='' >"+"请选择"+"</option>");
						 for(var i=0 ;i<cc.length ;i++){

						 	$("#cptypess").append(
						 		"<option class='cpzl'  value='" +cc[i].id+ "' >"+cc[i].crop_species+"</option>"
						 	);
						 }
					}else{
						$(".selec").remove();
							$("#cptypess").append("<option class='selec' value='' >"+"请选择"+"</option>");
						 for(var i=0 ;i<cc.length ;i++){

						 	$("#cptypess").append(
						 		"<option class='selec'  value='" +cc[i].id+ "' >"+cc[i].crop_species+"</option>"
						 	);
						 }

					}
				 }
			 });
		}else{
			alert("强选择原料类别！！！");
		}
	}

	</script>-->
</html>
